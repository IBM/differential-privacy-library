language: python
dist: xenial
python:
  - "3.4"
  - "3.5"
  - "3.6"
  - "3.7"
#  - "3.8-dev"
matrix:
  include:
    - python: 3.7
      script:
        - (pycodestyle --max-line-length=120 diffprivlib || exit 0) && (pylint -rn diffprivlib || exit 0)
#  allow_failures:
#    - python: 3.8-dev
#      script:
#        - pytest

install:
  - if [[ "$TRAVIS_PYTHON_VERSION" == "3.4" ]]; then
      pip install scikit-learn==0.20.3;
    fi
  - pip install pylint pycodestyle
  - pip install .

script: pytest

deploy:
  provider: pypi
  user: "__token__"
  password:
    secure: "pypi-AgEIcHlwaS5vcmcCJDg4MDZlZTRlLTI5OWMtNDY1MC1iZDY5LWY2ZjdmZmMzOTJiYwACPHsicGVybWlzc2lvbnMiOiB7InByb2plY3RzIjogWyJkaWZmcHJpdmxpYiJdfSwgInZlcnNpb24iOiAxfQAABiC9BkSJ7uYsqiGfXUDCHdYni_8BTnf6AuNwPqDS9NxqHg"
  on:
    tags: true
    branch: master
